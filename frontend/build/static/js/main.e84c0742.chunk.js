(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{156:function(e,t,a){},193:function(e){e.exports=JSON.parse('{"v":"5.5.2","fr":60,"ip":0,"op":104,"w":84,"h":40,"nm":"Typing-Indicator","ddd":0,"assets":[],"layers":[{"ddd":0,"ind":1,"ty":4,"nm":"Oval 3","sr":1,"ks":{"o":{"a":1,"k":[{"i":{"x":[0.643],"y":[1]},"o":{"x":[1],"y":[0]},"t":18,"s":[35],"e":[100]},{"i":{"x":[0.099],"y":[1]},"o":{"x":[0.129],"y":[0]},"t":33,"s":[100],"e":[35]},{"i":{"x":[0.833],"y":[1]},"o":{"x":[0.167],"y":[0]},"t":65,"s":[35],"e":[35]},{"t":71}],"ix":11,"x":"var $bm_rt;\\n$bm_rt = loopOut(\'cycle\', 0);"},"r":{"a":0,"k":0,"ix":10},"p":{"a":0,"k":[61,20,0],"ix":2},"a":{"a":0,"k":[0,0,0],"ix":1},"s":{"a":1,"k":[{"i":{"x":[0.667,0.667,0.667],"y":[1,1,1]},"o":{"x":[1,1,0.333],"y":[0,0,0]},"t":18,"s":[100,100,100],"e":[140,140,100]},{"i":{"x":[0.032,0.032,0.667],"y":[1,1,1]},"o":{"x":[0.217,0.217,0.333],"y":[0,0,0]},"t":33,"s":[140,140,100],"e":[100,100,100]},{"i":{"x":[0.833,0.833,0.833],"y":[1,1,1]},"o":{"x":[0.167,0.167,0.167],"y":[0,0,0]},"t":65,"s":[100,100,100],"e":[100,100,100]},{"t":71}],"ix":6,"x":"var $bm_rt;\\n$bm_rt = loopOut(\'cycle\', 0);"}},"ao":0,"shapes":[{"ty":"gr","it":[{"d":1,"ty":"el","s":{"a":0,"k":[12,12],"ix":2},"p":{"a":0,"k":[0,0],"ix":3},"nm":"Ellipse Path 1","mn":"ADBE Vector Shape - Ellipse","hd":false},{"ty":"fl","c":{"a":0,"k":[0.847000002861,0.847000002861,0.847000002861,1],"ix":4},"o":{"a":0,"k":100,"ix":5},"r":1,"bm":0,"nm":"Fill 1","mn":"ADBE Vector Graphic - Fill","hd":false},{"ty":"tr","p":{"a":0,"k":[0,0],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Oval 3","np":2,"cix":2,"bm":0,"ix":1,"mn":"ADBE Vector Group","hd":false}],"ip":0,"op":3600,"st":0,"bm":0},{"ddd":0,"ind":2,"ty":4,"nm":"Oval 2","sr":1,"ks":{"o":{"a":1,"k":[{"i":{"x":[0.667],"y":[1]},"o":{"x":[1],"y":[0]},"t":9,"s":[35],"e":[98]},{"i":{"x":[0.023],"y":[1]},"o":{"x":[0.179],"y":[0]},"t":24,"s":[98],"e":[35]},{"i":{"x":[0.833],"y":[1]},"o":{"x":[0.167],"y":[0]},"t":56,"s":[35],"e":[35]},{"t":62}],"ix":11,"x":"var $bm_rt;\\n$bm_rt = loopOut(\'cycle\', 0);"},"r":{"a":0,"k":0,"ix":10},"p":{"a":0,"k":[41,20,0],"ix":2},"a":{"a":0,"k":[0,0,0],"ix":1},"s":{"a":1,"k":[{"i":{"x":[0.654,0.654,0.667],"y":[1,1,1]},"o":{"x":[1,1,0.333],"y":[0,0,0]},"t":9,"s":[100,100,100],"e":[140,140,100]},{"i":{"x":[0.11,0.11,0.667],"y":[1,1,1]},"o":{"x":[0.205,0.205,0.333],"y":[0,0,0]},"t":24,"s":[140,140,100],"e":[100,100,100]},{"i":{"x":[0.833,0.833,0.833],"y":[1,1,1]},"o":{"x":[0.167,0.167,0.167],"y":[0,0,0]},"t":56,"s":[100,100,100],"e":[100,100,100]},{"t":62}],"ix":6,"x":"var $bm_rt;\\n$bm_rt = loopOut(\'cycle\', 0);"}},"ao":0,"shapes":[{"ty":"gr","it":[{"d":1,"ty":"el","s":{"a":0,"k":[12,12],"ix":2},"p":{"a":0,"k":[0,0],"ix":3},"nm":"Ellipse Path 1","mn":"ADBE Vector Shape - Ellipse","hd":false},{"ty":"fl","c":{"a":0,"k":[0.847000002861,0.847000002861,0.847000002861,1],"ix":4},"o":{"a":0,"k":100,"ix":5},"r":1,"bm":0,"nm":"Fill 1","mn":"ADBE Vector Graphic - Fill","hd":false},{"ty":"tr","p":{"a":0,"k":[0,0],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Oval 2","np":2,"cix":2,"bm":0,"ix":1,"mn":"ADBE Vector Group","hd":false}],"ip":0,"op":3600,"st":0,"bm":0},{"ddd":0,"ind":3,"ty":4,"nm":"Oval 1","sr":1,"ks":{"o":{"a":1,"k":[{"i":{"x":[0.667],"y":[1]},"o":{"x":[1],"y":[0]},"t":0,"s":[35],"e":[100]},{"i":{"x":[0.067],"y":[1]},"o":{"x":[0.125],"y":[0]},"t":15,"s":[100],"e":[35]},{"i":{"x":[0.833],"y":[1]},"o":{"x":[0.167],"y":[0]},"t":47,"s":[35],"e":[35]},{"t":53}],"ix":11,"x":"var $bm_rt;\\n$bm_rt = loopOut(\'cycle\', 0);"},"r":{"a":0,"k":0,"ix":10},"p":{"a":0,"k":[21,20,0],"ix":2},"a":{"a":0,"k":[0,0,0],"ix":1},"s":{"a":1,"k":[{"i":{"x":[0.673,0.673,0.667],"y":[1,1,1]},"o":{"x":[1,1,0.333],"y":[0,0,0]},"t":0,"s":[100,100,100],"e":[140,140,100]},{"i":{"x":[0.049,0.049,0.667],"y":[1,1,1]},"o":{"x":[0.198,0.198,0.333],"y":[0,0,0]},"t":15,"s":[140,140,100],"e":[100,100,100]},{"i":{"x":[0.833,0.833,0.833],"y":[1,1,1]},"o":{"x":[0.167,0.167,0.167],"y":[0,0,0]},"t":47,"s":[100,100,100],"e":[100,100,100]},{"t":53}],"ix":6,"x":"var $bm_rt;\\n$bm_rt = loopOut(\'cycle\', 0);"}},"ao":0,"shapes":[{"ty":"gr","it":[{"d":1,"ty":"el","s":{"a":0,"k":[12,12],"ix":2},"p":{"a":0,"k":[0,0],"ix":3},"nm":"Ellipse Path 1","mn":"ADBE Vector Shape - Ellipse","hd":false},{"ty":"fl","c":{"a":0,"k":[0.847000002861,0.847000002861,0.847000002861,1],"ix":4},"o":{"a":0,"k":100,"ix":5},"r":1,"bm":0,"nm":"Fill 1","mn":"ADBE Vector Graphic - Fill","hd":false},{"ty":"tr","p":{"a":0,"k":[0,0],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Oval 1","np":2,"cix":2,"bm":0,"ix":1,"mn":"ADBE Vector Group","hd":false}],"ip":0,"op":3600,"st":0,"bm":0},{"ddd":0,"ind":4,"ty":4,"nm":"BG","sr":1,"ks":{"o":{"a":0,"k":100,"ix":11},"r":{"a":0,"k":0,"ix":10},"p":{"a":0,"k":[42,20,0],"ix":2},"a":{"a":0,"k":[0,0,0],"ix":1},"s":{"a":0,"k":[100,100,100],"ix":6}},"ao":0,"shapes":[{"ty":"gr","it":[{"ind":0,"ty":"sh","ix":1,"ks":{"a":0,"k":{"i":[[0,0],[0,0],[0,0],[0,0]],"o":[[0,0],[0,0],[0,0],[0,0]],"v":[[-42,-20],[42,-20],[42,20],[-42,20]],"c":true},"ix":2},"nm":"Path 1","mn":"ADBE Vector Shape - Group","hd":false},{"ty":"rd","nm":"Round Corners 1","r":{"a":0,"k":20,"ix":1},"ix":2,"mn":"ADBE Vector Filter - RC","hd":false},{"ty":"fl","c":{"a":0,"k":[0.96078401804,0.96078401804,0.96078401804,1],"ix":4},"o":{"a":0,"k":100,"ix":5},"r":1,"bm":0,"nm":"Fill 1","mn":"ADBE Vector Graphic - Fill","hd":false},{"ty":"tr","p":{"a":0,"k":[0,0],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"BG","np":3,"cix":2,"bm":0,"ix":1,"mn":"ADBE Vector Group","hd":false}],"ip":0,"op":3600,"st":0,"bm":0}],"markers":[]}')},215:function(e,t,a){},216:function(e,t,a){},310:function(e,t,a){"use strict";a.r(t);var s,i=a(0),r=a.n(i),c=a(48),n=a.n(c),o=(a(215),a(216),a(339)),l=a(326),d=a(340),j=a(329),b=a(362),h=a(17),x=a(197),p=a(86),u=a(332),O=a(333),g=a(334),m=a(370),f=a(368),y=a(335),v=a(336),C=a(369),w=a(338),k=a(185),S=a(330),_=a(49),A=a(1);const z=Object(_.b)(s||(s=Object(k.a)(["\n  0% { transform: translateY(0px) scale(1); }\n  50% { transform: translateY(-10px) scale(1.02); }\n  100% { transform: translateY(0px) scale(1); }\n"])));var F=()=>Object(A.jsx)(l.a,{position:"relative",minH:{base:"280px",md:"520px"},children:Object(A.jsxs)(l.a,{h:"full",w:"full",borderRadius:"2xl",bgGradient:"linear(to-br, blue.500, purple.500)",position:"relative",overflow:"hidden",boxShadow:"lg",children:[Object(A.jsx)(l.a,{position:"absolute",top:"-20%",right:"-10%",w:"70%",h:"70%",bgGradient:"radial(circle at 50% 50%, rgba(255,255,255,0.28), transparent 60%)",filter:"blur(12px)"}),Object(A.jsx)(l.a,{position:"absolute",bottom:"-25%",left:"-15%",w:"80%",h:"70%",bgGradient:"radial(circle at 50% 50%, rgba(255,255,255,0.24), transparent 65%)",filter:"blur(14px)"}),Object(A.jsx)(l.a,{position:"absolute",top:"18%",left:"12%",w:"180px",h:"140px",bg:"whiteAlpha.300",borderRadius:"40px",backdropFilter:"auto",backdropBlur:"6px",boxShadow:"xl",animation:"".concat(z," 7s ease-in-out infinite")}),Object(A.jsx)(l.a,{position:"absolute",top:"46%",right:"16%",w:"220px",h:"160px",bg:"whiteAlpha.200",borderRadius:"50px",backdropFilter:"auto",backdropBlur:"8px",animation:"".concat(z," 9s ease-in-out infinite")}),Object(A.jsxs)(l.a,{position:"absolute",top:{base:5,md:8},left:{base:5,md:8},bg:"white",p:4,borderRadius:"xl",boxShadow:"2xl",minW:"200px",children:[Object(A.jsxs)(f.a,{justify:"space-between",mb:2,children:[Object(A.jsx)(j.a,{fontWeight:"bold",children:"Activity"}),Object(A.jsx)(S.a,{colorScheme:"green",children:"+12%"})]}),Object(A.jsx)(j.a,{fontSize:"3xl",fontWeight:"800",children:"176,18"}),Object(A.jsx)(j.a,{fontSize:"xs",color:"gray.500",children:"weekly messages"})]}),Object(A.jsxs)(l.a,{position:"absolute",bottom:{base:5,md:8},right:{base:5,md:8},bg:"white",p:4,borderRadius:"xl",boxShadow:"2xl",maxW:"260px",children:[Object(A.jsx)(j.a,{fontWeight:"semibold",mb:1,children:"Your data, your rules"}),Object(A.jsx)(j.a,{fontSize:"xs",color:"gray.600",children:"Choose what to share. We never post to your channels without permission."})]})]})}),E=a(9),B=a.n(E),I=a(360);const R=Object(i.createContext)(),W=()=>Object(i.useContext)(R);var T=e=>{let{children:t}=e;const[a,s]=Object(i.useState)(),[r,c]=Object(i.useState)(),[n,o]=Object(i.useState)([]),[l,d]=Object(i.useState)(),[j,b]=Object(i.useState)((()=>localStorage.getItem("appTheme")||"light")),x=Object(h.e)();return Object(i.useEffect)((()=>{const e=JSON.parse(localStorage.getItem("userInfo"));c(e),e||x.push("/")}),[x]),Object(i.useEffect)((()=>{r&&r._id&&localStorage.setItem("appTheme:".concat(r._id),j),localStorage.setItem("appTheme",j)}),[j,r]),Object(i.useEffect)((()=>{if(r&&r._id){const e=localStorage.getItem("appTheme:".concat(r._id));e&&b(e)}}),[r]),Object(A.jsx)(R.Provider,{value:{selectedChat:a,setSelectedChat:s,user:r,setUser:c,notification:n,setNotification:o,chats:l,setChats:d,appTheme:j,setAppTheme:b},children:t})};var N=()=>{const[e,t]=Object(i.useState)(!1),a=Object(I.a)(),[s,r]=Object(i.useState)(),[c,n]=Object(i.useState)(),[o,d]=Object(i.useState)(!1),b=Object(h.e)(),{setUser:k}=W();return Object(A.jsx)(l.a,{w:"full",children:Object(A.jsxs)(C.a,{columns:{base:1,md:2},gap:{base:6,md:10},children:[Object(A.jsxs)(l.a,{bg:"white",borderRadius:"xl",boxShadow:"lg",borderWidth:"1px",p:{base:4,md:8},children:[Object(A.jsx)(j.a,{fontSize:{base:"xl",md:"2xl"},fontWeight:"bold",children:"Login"}),Object(A.jsx)(j.a,{color:"gray.500",mb:6,mt:1,children:"Welcome back! Enter your credentials to continue."}),Object(A.jsxs)(f.c,{spacing:4,align:"stretch",children:[Object(A.jsxs)(p.a,{id:"email",isRequired:!0,children:[Object(A.jsx)(u.a,{children:"Email address"}),Object(A.jsxs)(O.a,{children:[Object(A.jsx)(g.a,{pointerEvents:"none",children:Object(A.jsx)(y.a,{color:"gray.400"})}),Object(A.jsx)(m.a,{value:s,type:"email",placeholder:"Enter your email",onChange:e=>r(e.target.value),focusBorderColor:"blue.400"})]})]}),Object(A.jsxs)(p.a,{id:"password",isRequired:!0,children:[Object(A.jsx)(u.a,{children:"Password"}),Object(A.jsxs)(O.a,{size:"md",children:[Object(A.jsx)(g.a,{pointerEvents:"none",children:Object(A.jsx)(v.a,{color:"gray.400"})}),Object(A.jsx)(m.a,{value:c,onChange:e=>n(e.target.value),type:e?"text":"password",placeholder:"Enter your password",focusBorderColor:"blue.400"}),Object(A.jsx)(g.b,{width:"4.5rem",children:Object(A.jsx)(x.a,{h:"1.75rem",size:"sm",onClick:()=>t(!e),variant:"ghost",children:e?"Hide":"Show"})})]})]}),Object(A.jsxs)(f.b,{spacing:4,direction:{base:"column",sm:"row"},align:"stretch",children:[Object(A.jsx)(x.a,{colorScheme:"blue",w:{base:"100%",sm:"70%"},onClick:async()=>{if(d(!0),!s||!c)return a({title:"Please Fill all the Feilds",status:"warning",duration:5e3,isClosable:!0,position:"bottom"}),void d(!1);try{const e={headers:{"Content-type":"application/json"}},{data:t}=await B.a.post("/api/user/login",{email:s,password:c},e);a({title:"Login Successful",status:"success",duration:5e3,isClosable:!0,position:"bottom"}),k(t),localStorage.setItem("userInfo",JSON.stringify(t)),d(!1),b.push("/chats")}catch(e){a({title:"Error Occured!",description:e.response.data.message,status:"error",duration:5e3,isClosable:!0,position:"bottom"}),d(!1)}},isLoading:o,children:"Login"}),Object(A.jsx)(x.a,{variant:"outline",colorScheme:"red",w:{base:"100%",sm:"30%"},onClick:()=>{r("guest@example.com"),n("123456")},children:"Use Guest"})]}),Object(A.jsxs)(f.a,{spacing:3,justify:"center",pt:2,color:"gray.500",children:[Object(A.jsx)(j.a,{fontSize:"sm",children:"Or continue with"}),Object(A.jsxs)(f.a,{spacing:2,children:[Object(A.jsx)(w.a,{"aria-label":"alt-1",size:"sm",variant:"ghost",icon:Object(A.jsx)(y.a,{})}),Object(A.jsx)(w.a,{"aria-label":"alt-2",size:"sm",variant:"ghost",icon:Object(A.jsx)(v.a,{})})]})]})]})]}),Object(A.jsx)(F,{})]})})};var D=()=>{const[e,t]=Object(i.useState)(!1),a=()=>t(!e),s=Object(I.a)(),r=Object(h.e)(),[c,n]=Object(i.useState)(),[o,d]=Object(i.useState)(),[b,k]=Object(i.useState)(),[S,_]=Object(i.useState)(),[z,E]=Object(i.useState)(),[R,W]=Object(i.useState)(!1);return Object(A.jsx)(l.a,{w:"full",children:Object(A.jsxs)(C.a,{columns:{base:1,md:2},gap:{base:6,md:10},children:[Object(A.jsxs)(l.a,{bg:"white",borderRadius:"xl",boxShadow:"lg",borderWidth:"1px",p:{base:4,md:8},children:[Object(A.jsx)(j.a,{fontSize:{base:"xl",md:"2xl"},fontWeight:"bold",children:"Sign Up"}),Object(A.jsx)(j.a,{color:"gray.500",mb:6,mt:1,children:"Create your VibeLine account and start chatting instantly."}),Object(A.jsxs)(f.c,{spacing:4,align:"stretch",children:[Object(A.jsxs)(p.a,{id:"first-name",isRequired:!0,children:[Object(A.jsx)(u.a,{children:"Name"}),Object(A.jsx)(m.a,{placeholder:"Enter your name",onChange:e=>n(e.target.value)})]}),Object(A.jsxs)(p.a,{id:"email",isRequired:!0,children:[Object(A.jsx)(u.a,{children:"Email address"}),Object(A.jsxs)(O.a,{children:[Object(A.jsx)(g.a,{pointerEvents:"none",children:Object(A.jsx)(y.a,{color:"gray.400"})}),Object(A.jsx)(m.a,{type:"email",placeholder:"Enter your email",onChange:e=>d(e.target.value),focusBorderColor:"blue.400"})]})]}),Object(A.jsxs)(p.a,{id:"password",isRequired:!0,children:[Object(A.jsx)(u.a,{children:"Password"}),Object(A.jsxs)(O.a,{size:"md",children:[Object(A.jsx)(g.a,{pointerEvents:"none",children:Object(A.jsx)(v.a,{color:"gray.400"})}),Object(A.jsx)(m.a,{type:e?"text":"password",placeholder:"Enter password",onChange:e=>_(e.target.value),focusBorderColor:"blue.400"}),Object(A.jsx)(g.b,{width:"4.5rem",children:Object(A.jsx)(x.a,{h:"1.75rem",size:"sm",onClick:a,variant:"ghost",children:e?"Hide":"Show"})})]})]}),Object(A.jsxs)(p.a,{id:"password-confirm",isRequired:!0,children:[Object(A.jsx)(u.a,{children:"Confirm Password"}),Object(A.jsxs)(O.a,{size:"md",children:[Object(A.jsx)(g.a,{pointerEvents:"none",children:Object(A.jsx)(v.a,{color:"gray.400"})}),Object(A.jsx)(m.a,{type:e?"text":"password",placeholder:"Confirm password",onChange:e=>k(e.target.value),focusBorderColor:"blue.400"}),Object(A.jsx)(g.b,{width:"4.5rem",children:Object(A.jsx)(x.a,{h:"1.75rem",size:"sm",onClick:a,variant:"ghost",children:e?"Hide":"Show"})})]})]}),Object(A.jsxs)(p.a,{id:"pic",children:[Object(A.jsx)(u.a,{children:"Upload your picture"}),Object(A.jsx)(m.a,{type:"file",p:1.5,accept:"image/*",onChange:e=>(e=>{if(W(!0),void 0!==e){if(console.log(e),"image/jpeg"!==e.type&&"image/png"!==e.type)return s({title:"Please Select an Image!",status:"warning",duration:5e3,isClosable:!0,position:"bottom"}),void W(!1);{const t=new FormData;t.append("file",e),t.append("upload_preset","chat-app"),t.append("cloud_name","piyushproj"),fetch("https://api.cloudinary.com/v1_1/piyushproj/image/upload",{method:"post",body:t}).then((e=>e.json())).then((e=>{E(e.url.toString()),console.log(e.url.toString()),W(!1)})).catch((e=>{console.log(e),W(!1)}))}}else s({title:"Please Select an Image!",status:"warning",duration:5e3,isClosable:!0,position:"bottom"})})(e.target.files[0])})]}),Object(A.jsx)(x.a,{colorScheme:"blue",w:"100%",mt:2,onClick:async()=>{if(W(!0),!c||!o||!S||!b)return s({title:"Please Fill all the Feilds",status:"warning",duration:5e3,isClosable:!0,position:"bottom"}),void W(!1);if(S===b){console.log(c,o,S,z);try{const e={headers:{"Content-type":"application/json"}},{data:t}=await B.a.post("/api/user",{name:c,email:o,password:S,pic:z},e);console.log(t),s({title:"Registration Successful",status:"success",duration:5e3,isClosable:!0,position:"bottom"}),localStorage.setItem("userInfo",JSON.stringify(t)),W(!1),r.push("/chats")}catch(e){s({title:"Error Occured!",description:e.response.data.message,status:"error",duration:5e3,isClosable:!0,position:"bottom"}),W(!1)}}else s({title:"Passwords Do Not Match",status:"warning",duration:5e3,isClosable:!0,position:"bottom"})},isLoading:R,children:"Create account"}),Object(A.jsxs)(f.a,{spacing:3,justify:"center",pt:2,color:"gray.500",children:[Object(A.jsx)(j.a,{fontSize:"sm",children:"Or continue with"}),Object(A.jsxs)(f.a,{spacing:2,children:[Object(A.jsx)(w.a,{"aria-label":"alt-1",size:"sm",variant:"ghost",icon:Object(A.jsx)(y.a,{})}),Object(A.jsx)(w.a,{"aria-label":"alt-2",size:"sm",variant:"ghost",icon:Object(A.jsx)(v.a,{})})]})]})]})]}),Object(A.jsx)(F,{})]})})};var G=function(){const e=Object(h.e)();return Object(i.useEffect)((()=>{JSON.parse(localStorage.getItem("userInfo"))&&e.push("/chats")}),[e]),Object(A.jsx)(o.a,{maxW:"100%",centerContent:!1,px:0,py:{base:6,md:10},children:Object(A.jsxs)(l.a,{w:"full",maxW:"1400px",mx:"auto",px:{base:4,md:8},children:[Object(A.jsxs)(l.a,{textAlign:"center",mb:{base:4,md:6},children:[Object(A.jsx)(d.a,{size:"lg",bgGradient:"linear(to-r, blue.500, teal.400)",bgClip:"text",fontFamily:"Work sans",children:"VibeLine"}),Object(A.jsx)(j.a,{mt:2,color:"gray.600",fontSize:{base:"sm",md:"md"},children:"Welcome back. Please sign in or create a new account to continue."})]}),Object(A.jsxs)(b.e,{isFitted:!0,colorScheme:"blue",variant:"enclosed",children:[Object(A.jsxs)(b.b,{mb:6,children:[Object(A.jsx)(b.a,{fontWeight:"600",children:"Login"}),Object(A.jsx)(b.a,{fontWeight:"600",children:"Sign Up"})]}),Object(A.jsxs)(b.d,{children:[Object(A.jsx)(b.c,{px:0,children:Object(A.jsx)(N,{})}),Object(A.jsx)(b.c,{px:0,children:Object(A.jsx)(D,{})})]})]})]})})},P=a(356),L=a(78),U=(a(156),a(344)),V=a(342),M=a(337);const J=(e,t,a,s)=>a<e.length-1&&e[a+1].sender._id===t.sender._id&&e[a].sender._id!==s?33:a<e.length-1&&e[a+1].sender._id!==t.sender._id&&e[a].sender._id!==s||a===e.length-1&&e[a].sender._id!==s?0:"auto",Y=(e,t,a,s)=>a<e.length-1&&(e[a+1].sender._id!==t.sender._id||void 0===e[a+1].sender._id)&&e[a].sender._id!==s,$=(e,t,a)=>t===e.length-1&&e[e.length-1].sender._id!==a&&e[e.length-1].sender._id,H=(e,t,a)=>a>0&&e[a-1].sender._id===t.sender._id,q=(e,t)=>t[0]._id===e._id?t[1]:t[0],K=(e,t,a)=>((e,t)=>{const a=((null===e||void 0===e?void 0:e.nicknames)||[]).find((e=>{var a;return((null===(a=e.user)||void 0===a?void 0:a._id)||e.user)===t}));return(null===a||void 0===a?void 0:a.name)||""})(e,t)||a||"",Q=(e,t)=>{const a=q(e,t.users);return K(t,null===a||void 0===a?void 0:a._id,null===a||void 0===a?void 0:a.name)};var X=a(343),Z=a(359),ee=a(189);var te=e=>{let{messages:t}=e;const{user:a,appTheme:s}=W();return Object(A.jsx)(ee.a,{children:t&&t.map(((e,i)=>{var r;return Object(A.jsxs)("div",{style:{display:"flex"},children:[(Y(t,e,i,a._id)||$(t,i,a._id))&&Object(A.jsx)(Z.a,{label:K(e.chat||{},e.sender._id,e.sender.name),placement:"bottom-start",hasArrow:!0,children:Object(A.jsx)(V.a,{mt:"7px",mr:1,size:"sm",cursor:"pointer",name:e.sender.name,src:(null===(r=e.sender)||void 0===r?void 0:r.pic)||void 0})}),Object(A.jsx)("span",{style:{backgroundColor:e.sender._id===a._id?"dark"===s?"#2563EB":"#25D366":"dark"===s?"#374151":"#DCF8C6",color:"".concat(e.sender._id===a._id?"white":"dark"===s?"#E5E7EB":"#202C33"),marginLeft:J(t,e,i,a._id),marginTop:H(t,e,i,a._id)?3:10,borderRadius:"20px",padding:"5px 15px",maxWidth:"75%"},children:e.content})]},e._id)}))})},ae=a(192),se=a.n(ae),ie=a(193),re=a(194),ce=a.n(re);var ne,oe;var le=e=>{var t,a;let{fetchAgain:s,setFetchAgain:r,variant:c="light",onToggleInfo:n}=e;const{appTheme:o}=W(),[d,b]=Object(i.useState)([]),[h,x]=Object(i.useState)(!1),[u,O]=Object(i.useState)(""),[g,y]=Object(i.useState)(!1),[v,C]=Object(i.useState)(!1),[k,S]=Object(i.useState)(!1),_=Object(I.a)(),z={loop:!0,autoplay:!0,animationData:ie,rendererSettings:{preserveAspectRatio:"xMidYMid slice"}},{selectedChat:F,setSelectedChat:E,user:R,notification:T,setNotification:N}=W();Object(i.useEffect)((()=>{(ne=ce()("http://localhost:5000")).emit("setup",R),ne.on("connected",(()=>y(!0))),ne.on("typing",(()=>S(!0))),ne.on("stop typing",(()=>S(!1)))}),[]),Object(i.useEffect)((()=>{(async()=>{if(F)try{const e={headers:{Authorization:"Bearer ".concat(R.token)}};x(!0);const{data:t}=await B.a.get("/api/message/".concat(F._id),e);b(t),x(!1),ne.emit("join chat",F._id)}catch(e){_({title:"Error Occured!",description:"Failed to Load the Messages",status:"error",duration:5e3,isClosable:!0,position:"bottom"})}})(),oe=F}),[F]),Object(i.useEffect)((()=>{ne.on("message recieved",(e=>{oe&&oe._id===e.chat._id?b([...d,e]):T.includes(e)||(N([e,...T]),r(!s))}))}));return Object(A.jsx)(A.Fragment,{children:F?Object(A.jsxs)(A.Fragment,{children:[Object(A.jsxs)(f.a,{w:"100%",pb:3,px:2,alignItems:"center",children:[Object(A.jsx)(w.a,{d:{base:"flex",md:"none"},icon:Object(A.jsx)(X.a,{}),onClick:()=>E(""),"aria-label":"back"}),Object(A.jsxs)(f.a,{spacing:3,children:[Object(A.jsx)(V.a,{size:"sm",name:F.isGroupChat?F.chatName:null===(t=q(R,F.users))||void 0===t?void 0:t.name,src:F.isGroupChat?void 0:(null===(a=q(R,F.users))||void 0===a?void 0:a.pic)||void 0}),Object(A.jsx)(j.a,{fontSize:{base:"24px",md:"28px"},fontFamily:"Work sans",fontWeight:"700",children:d&&(F.isGroupChat?F.chatName:Q(R,F))})]}),Object(A.jsx)(U.a,{}),Object(A.jsx)(w.a,{"aria-label":"chat details",icon:Object(A.jsx)(j.a,{fontSize:"xl",children:"\u22ee"}),variant:"dark"===o?"outline":"solid",colorScheme:"blue",size:"sm",onClick:n})]}),Object(A.jsxs)(l.a,{d:"flex",flexDir:"column",justifyContent:"flex-end",p:3,bg:"dark"===o?"gray.900":"brand.background",w:"100%",h:"100%",borderRadius:"lg",overflowY:"hidden",children:[h?Object(A.jsx)(M.a,{size:"xl",w:20,h:20,alignSelf:"center",margin:"auto"}):Object(A.jsx)("div",{className:"messages",children:Object(A.jsx)(te,{messages:d})}),Object(A.jsxs)(p.a,{onKeyDown:async e=>{if("Enter"===e.key&&u){ne.emit("stop typing",F._id);try{const e={headers:{"Content-type":"application/json",Authorization:"Bearer ".concat(R.token)}};O("");const{data:t}=await B.a.post("/api/message",{content:u,chatId:F},e);ne.emit("new message",t),b([...d,t])}catch(t){_({title:"Error Occured!",description:"Failed to send the Message",status:"error",duration:5e3,isClosable:!0,position:"bottom"})}}},id:"first-name",isRequired:!0,mt:3,children:[k?Object(A.jsx)("div",{children:Object(A.jsx)(se.a,{options:z,width:70,style:{marginBottom:15,marginLeft:0}})}):Object(A.jsx)(A.Fragment,{}),Object(A.jsx)(m.a,{variant:"filled",bg:"dark"===o?"gray.700":"white",placeholder:"Enter a message..",value:u,onChange:e=>{if(O(e.target.value),!g)return;v||(C(!0),ne.emit("typing",F._id));let t=(new Date).getTime();setTimeout((()=>{(new Date).getTime()-t>=3e3&&v&&(ne.emit("stop typing",F._id),C(!1))}),3e3)}})]})]})]}):Object(A.jsx)(l.a,{d:"flex",alignItems:"center",justifyContent:"center",h:"100%",children:Object(A.jsx)(j.a,{fontSize:"3xl",pb:3,fontFamily:"Work sans",children:"Click on a user to start chatting"})})})};var de=e=>{let{fetchAgain:t,setFetchAgain:a,variant:s="light",containerProps:i={},onToggleInfo:r}=e;const{selectedChat:c}=W();return Object(A.jsx)(l.a,Object(L.a)(Object(L.a)({d:{base:c?"flex":"none",md:"flex"},alignItems:"center",flexDir:"column",p:3,bg:"dark"===s?"gray.800":"white",w:{base:"100%",md:"68%"},borderRadius:"lg",borderWidth:"1px",borderColor:"dark"===s?"whiteAlpha.300":"gray.200",color:"dark"===s?"gray.100":"inherit"},i),{},{children:Object(A.jsx)(le,{fetchAgain:t,setFetchAgain:a,variant:s,onToggleInfo:r})}))},je=a(350),be=a(363);var he=()=>Object(A.jsxs)(f.b,{children:[Object(A.jsx)(be.a,{height:"45px"}),Object(A.jsx)(be.a,{height:"45px"}),Object(A.jsx)(be.a,{height:"45px"}),Object(A.jsx)(be.a,{height:"45px"}),Object(A.jsx)(be.a,{height:"45px"}),Object(A.jsx)(be.a,{height:"45px"}),Object(A.jsx)(be.a,{height:"45px"}),Object(A.jsx)(be.a,{height:"45px"}),Object(A.jsx)(be.a,{height:"45px"}),Object(A.jsx)(be.a,{height:"45px"}),Object(A.jsx)(be.a,{height:"45px"}),Object(A.jsx)(be.a,{height:"45px"})]}),xe=a(341),pe=a(47),ue=a(345);var Oe=e=>{let{user:t,handleFunction:a,admin:s}=e;return Object(A.jsxs)(S.a,{px:2,py:1,borderRadius:"lg",m:1,mb:2,variant:"solid",fontSize:12,colorScheme:"purple",cursor:"pointer",onClick:a,children:[t.name,s===t._id&&Object(A.jsx)("span",{children:" (Admin)"}),Object(A.jsx)(ue.a,{pl:1})]})};var ge=e=>{let{handleFunction:t}=e;const{user:a}=W();return Object(A.jsxs)(l.a,{onClick:t,cursor:"pointer",bg:"#E8E8E8",_hover:{background:"#38B2AC",color:"white"},w:"100%",d:"flex",alignItems:"center",color:"black",px:3,py:2,mb:2,borderRadius:"lg",children:[Object(A.jsx)(V.a,{mr:2,size:"sm",cursor:"pointer",name:a.name,src:a.pic}),Object(A.jsxs)(l.a,{children:[Object(A.jsx)(j.a,{children:a.name}),Object(A.jsxs)(j.a,{fontSize:"xs",children:[Object(A.jsx)("b",{children:"Email : "}),a.email]})]})]})};var me=e=>{let{children:t}=e;const{isOpen:a,onOpen:s,onClose:r}=Object(xe.a)(),[c,n]=Object(i.useState)(),[o,d]=Object(i.useState)([]),[j,b]=Object(i.useState)(""),[h,u]=Object(i.useState)([]),[O,g]=Object(i.useState)(!1),f=Object(I.a)(),{user:y,chats:v,setChats:C}=W();return Object(A.jsxs)(A.Fragment,{children:[Object(A.jsx)("span",{onClick:s,children:t}),Object(A.jsxs)(pe.a,{onClose:r,isOpen:a,isCentered:!0,children:[Object(A.jsx)(pe.h,{}),Object(A.jsxs)(pe.d,{children:[Object(A.jsx)(pe.g,{fontSize:"35px",fontFamily:"Work sans",d:"flex",justifyContent:"center",children:"Create Group Chat"}),Object(A.jsx)(pe.c,{}),Object(A.jsxs)(pe.b,{d:"flex",flexDir:"column",alignItems:"center",children:[Object(A.jsx)(p.a,{children:Object(A.jsx)(m.a,{placeholder:"Chat Name",mb:3,onChange:e=>n(e.target.value)})}),Object(A.jsx)(p.a,{children:Object(A.jsx)(m.a,{placeholder:"Add Users eg: John,  Maryam, Jane",mb:1,onChange:e=>(async e=>{if(b(e),e)try{g(!0);const e={headers:{Authorization:"Bearer ".concat(y.token)}},{data:t}=await B.a.get("/api/user?search=".concat(j),e);console.log(t),g(!1),u(t)}catch(t){f({title:"Error Occured!",description:"Failed to Load the Search Results",status:"error",duration:5e3,isClosable:!0,position:"bottom-left"})}})(e.target.value)})}),Object(A.jsx)(l.a,{w:"100%",d:"flex",flexWrap:"wrap",children:o.map((e=>Object(A.jsx)(Oe,{user:e,handleFunction:()=>{return t=e,void d(o.filter((e=>e._id!==t._id)));var t}},e._id)))}),O?Object(A.jsx)("div",{children:"Loading..."}):null===h||void 0===h?void 0:h.slice(0,4).map((e=>Object(A.jsx)(ge,{user:e,handleFunction:()=>{return t=e,void(o.includes(t)?f({title:"User already added",status:"warning",duration:5e3,isClosable:!0,position:"top"}):d([...o,t]));var t}},e._id)))]}),Object(A.jsx)(pe.f,{children:Object(A.jsx)(x.a,{onClick:async()=>{if(c&&o)try{const e={headers:{Authorization:"Bearer ".concat(y.token)}},{data:t}=await B.a.post("/api/chat/group",{name:c,users:JSON.stringify(o.map((e=>e._id)))},e);C([t,...v]),r(),f({title:"New Group Chat Created!",status:"success",duration:5e3,isClosable:!0,position:"bottom"})}catch(e){f({title:"Failed to Create the Chat!",description:e.response.data,status:"error",duration:5e3,isClosable:!0,position:"bottom"})}else f({title:"Please fill all the feilds",status:"warning",duration:5e3,isClosable:!0,position:"top"})},colorScheme:"blue",children:"Create Chat"})})]})]})]})},fe=a(346),ye=a(347),ve=a(348);var Ce=e=>{let{user:t,children:a}=e;const{isOpen:s,onOpen:i,onClose:c}=Object(xe.a)(),{setUser:n}=W(),[o,l]=r.a.useState(!1),[d,b]=r.a.useState((null===t||void 0===t?void 0:t.name)||""),[h,O]=r.a.useState((null===t||void 0===t?void 0:t.pic)||""),[g,y]=r.a.useState(!1);return Object(A.jsxs)(A.Fragment,{children:[a?Object(A.jsx)("span",{onClick:i,children:a}):Object(A.jsx)(w.a,{d:{base:"flex"},icon:Object(A.jsx)(fe.a,{}),onClick:i}),Object(A.jsxs)(pe.a,{size:"lg",onClose:c,isOpen:s,isCentered:!0,children:[Object(A.jsx)(pe.h,{}),Object(A.jsxs)(pe.d,{children:[Object(A.jsx)(pe.g,{fontSize:"40px",fontFamily:"Work sans",d:"flex",justifyContent:"center",children:t.name}),Object(A.jsx)(pe.c,{}),Object(A.jsx)(pe.b,{children:Object(A.jsxs)(f.c,{spacing:4,align:"stretch",children:[Object(A.jsx)(f.a,{spacing:4,align:"center",justify:"center",children:Object(A.jsx)(ye.a,{borderRadius:"full",boxSize:"120px",src:h,alt:d})}),Object(A.jsxs)(f.c,{spacing:2,align:"stretch",children:[Object(A.jsx)(j.a,{fontSize:"sm",color:"gray.500",children:"Email"}),Object(A.jsx)(j.a,{children:t.email}),Object(A.jsx)(ve.a,{}),o?Object(A.jsxs)(A.Fragment,{children:[Object(A.jsxs)(p.a,{children:[Object(A.jsx)(u.a,{children:"Name"}),Object(A.jsx)(m.a,{value:d,onChange:e=>b(e.target.value)})]}),Object(A.jsxs)(p.a,{children:[Object(A.jsx)(u.a,{children:"Profile image URL"}),Object(A.jsx)(m.a,{value:h,onChange:e=>O(e.target.value)})]})]}):Object(A.jsx)(A.Fragment,{children:Object(A.jsxs)(j.a,{children:[Object(A.jsx)("b",{children:"Name:"})," ",d]})})]})]})}),Object(A.jsx)(pe.f,{children:Object(A.jsxs)(f.a,{w:"full",justify:"space-between",children:[Object(A.jsx)(x.a,{variant:"ghost",onClick:()=>{localStorage.removeItem("userInfo"),window.location.href="/"},children:"Logout"}),Object(A.jsxs)(f.a,{children:[Object(A.jsx)(x.a,{variant:"ghost",onClick:c,children:"Close"}),o?Object(A.jsx)(x.a,{colorScheme:"blue",isLoading:g,onClick:async()=>{try{var e;y(!0);const t={headers:{Authorization:"Bearer ".concat(null===(e=JSON.parse(localStorage.getItem("userInfo")))||void 0===e?void 0:e.token)}},{data:a}=await B.a.put("/api/user/profile",{name:d,pic:h},t);localStorage.setItem("userInfo",JSON.stringify(a)),n(a),l(!1)}catch(t){}finally{y(!1)}},children:"Save"}):Object(A.jsx)(x.a,{onClick:()=>l(!0),children:"Edit"})]})]})})]})]})]})},we=a(349),ke=a(351);var Se=e=>{let{fetchAgain:t,variant:a="light",containerProps:s={},onStartNew:r,onSelectChat:c}=e;const[n,o]=Object(i.useState)(),{selectedChat:d,setSelectedChat:b,user:p,chats:u,setChats:y,notification:v,appTheme:C}=W(),k=Object(I.a)();Object(i.useEffect)((()=>{o(JSON.parse(localStorage.getItem("userInfo"))),(async()=>{try{const e={headers:{Authorization:"Bearer ".concat(p.token)}},{data:t}=await B.a.get("/api/chat",e);y(t)}catch(e){k({title:"Error Occured!",description:"Failed to Load the chats",status:"error",duration:5e3,isClosable:!0,position:"bottom-left"})}})()}),[t]);const S="dark"===C,[_,z]=Object(i.useState)(""),[F,E]=Object(i.useState)([]),[R,T]=Object(i.useState)(!1);Object(h.e)();return Object(A.jsx)(A.Fragment,{children:Object(A.jsxs)(l.a,Object(L.a)(Object(L.a)({d:{base:d?"none":"flex",md:"flex"},flexDir:"column",alignItems:"center",p:3,bg:S?"gray.800":"brand.surface",w:{base:"100%",md:"31%"},borderRadius:"lg",borderWidth:"1px",borderColor:S?"whiteAlpha.300":"gray.200",color:S?"gray.100":"inherit"},s),{},{children:[Object(A.jsxs)(f.a,{pb:3,px:3,w:"100%",justify:"space-between",align:"center",children:[Object(A.jsxs)(f.a,{spacing:3,children:[Object(A.jsx)(Ce,{user:p,children:Object(A.jsx)(V.a,{size:"sm",name:null===p||void 0===p?void 0:p.name,src:null===p||void 0===p?void 0:p.pic,cursor:"pointer"})}),Object(A.jsx)(j.a,{fontSize:{base:"22px",md:"24px"},fontWeight:"700",fontFamily:"Work sans",children:"Chats"})]}),Object(A.jsxs)(f.a,{children:[Object(A.jsx)(w.a,{"aria-label":"new",icon:Object(A.jsx)(we.a,{}),size:"sm",variant:"ghost",onClick:()=>r&&r()}),Object(A.jsx)(me,{children:Object(A.jsx)(w.a,{"aria-label":"new group",icon:Object(A.jsx)(je.a,{}),size:"sm",colorScheme:"blue"})})]})]}),Object(A.jsx)(l.a,{px:3,w:"100%",pb:2,children:Object(A.jsxs)(O.a,{size:"sm",children:[Object(A.jsx)(g.a,{pointerEvents:"none",children:Object(A.jsx)(ke.a,{color:S?"gray.300":"brand.secondary"})}),Object(A.jsx)(m.a,{placeholder:"Search Messenger",bg:S?"gray.700":"white",border:"none",borderRadius:"full",color:S?"gray.100":"brand.text",_placeholder:{color:S?"gray.400":"gray.500"},value:_,onChange:e=>(async t=>{if(z(t),t)try{T(!0);const e={headers:{Authorization:"Bearer ".concat(p.token)}},{data:a}=await B.a.get("/api/user?search=".concat(encodeURIComponent(t)),e);E((a||[]).filter((e=>e._id!==p._id)))}catch(e){}finally{T(!1)}else E([])})(e.target.value)})]})}),Object(A.jsxs)(l.a,{d:"flex",flexDir:"column",p:3,bg:S?"gray.800":"#F8F8F8",w:"100%",h:"100%",borderRadius:"lg",overflowY:"hidden",children:[_&&Object(A.jsxs)(f.c,{align:"stretch",spacing:1,mb:3,children:[R&&Object(A.jsx)(j.a,{fontSize:"sm",color:S?"gray.300":"gray.600",children:"Searching\u2026"}),!R&&0===F.length&&Object(A.jsx)(j.a,{fontSize:"sm",color:S?"gray.300":"gray.600",children:"No users found"}),!R&&F.map((e=>Object(A.jsxs)(f.a,{spacing:3,p:2,borderRadius:"md",_hover:{bg:S?"gray.700":"white"},cursor:"pointer",onClick:()=>(async e=>{try{const t={headers:{"Content-type":"application/json",Authorization:"Bearer ".concat(p.token)}},{data:a}=await B.a.post("/api/chat",{userId:e},t);u.find((e=>e._id===a._id))||y([a,...u||[]]),b(a),z(""),E([])}catch(t){}})(e._id),children:[Object(A.jsx)(V.a,{size:"sm",name:e.name,src:e.pic}),Object(A.jsxs)(f.c,{spacing:0,align:"start",flex:1,children:[Object(A.jsx)(j.a,{fontWeight:600,children:e.name}),Object(A.jsx)(j.a,{fontSize:"xs",color:S?"gray.300":"gray.600",children:e.email})]}),Object(A.jsx)(x.a,{size:"xs",colorScheme:"blue",children:"Chat"})]},e._id)))]}),u?Object(A.jsx)(f.b,{overflowY:"scroll",spacing:1,children:u.filter((e=>(e.isGroupChat?e.chatName:Q(n,e)).toLowerCase().includes(_.toLowerCase()))).map((e=>{var t,a;const s=e.isGroupChat?e.chatName:Q(n,e),i=e.latestMessage,r=null===v||void 0===v?void 0:v.some((t=>t.chat&&t.chat._id===e._id)),o=d===e,h="#E7F3FF";return Object(A.jsxs)(f.a,{onClick:()=>{b(e),c&&c()},cursor:"pointer",spacing:3,p:2,borderRadius:"md",bg:o?S?"blue.700":h:"transparent",_hover:{bg:o?S?"blue.700":h:S?"gray.700":"#F0F2F5"},color:o?S?"white":"inherit":S?"gray.100":"black",align:"center",children:[Object(A.jsx)(V.a,{size:"sm",name:s,src:e.isGroupChat?void 0:(null===(t=(e.users||[]).find((e=>e._id!==(null===n||void 0===n?void 0:n._id))))||void 0===t?void 0:t.pic)||void 0}),Object(A.jsxs)(f.c,{spacing:0,align:"start",flex:1,children:[Object(A.jsx)(j.a,{fontWeight:r?"700":"600",noOfLines:1,children:s}),i&&Object(A.jsxs)(j.a,{fontSize:"xs",color:o?S?"whiteAlpha.900":"gray.600":S?"gray.300":"gray.600",noOfLines:1,children:[(null===(a=i.sender)||void 0===a?void 0:a._id)?"".concat(K(e,i.sender._id,i.sender.name),": "):"",i.content]})]}),r&&Object(A.jsx)(l.a,{w:2,h:2,bg:S?"#60A5FA":"#0084FF",borderRadius:"full"})]},e._id)}))}):Object(A.jsx)(he,{})]})]}))})},_e=a(372);a(181);var Ae=function(){const[e,t]=Object(i.useState)(""),[a,s]=Object(i.useState)([]),[r,c]=Object(i.useState)(!1),[n,o]=Object(i.useState)(!1),{setSelectedChat:d,user:j,notification:b,setNotification:p,chats:u,setChats:O}=W(),g=Object(I.a)(),{isOpen:f,onOpen:y,onClose:v}=Object(xe.a)(),C=(Object(h.e)(),async e=>{console.log(e);try{o(!0);const t={headers:{"Content-type":"application/json",Authorization:"Bearer ".concat(j.token)}},{data:a}=await B.a.post("/api/chat",{userId:e},t);u.find((e=>e._id===a._id))||O([a,...u]),d(a),o(!1),v()}catch(t){g({title:"Error fetching the chat",description:t.message,status:"error",duration:5e3,isClosable:!0,position:"bottom-left"})}});return Object(A.jsx)(A.Fragment,{children:Object(A.jsxs)(_e.a,{placement:"left",onClose:v,isOpen:f,children:[Object(A.jsx)(pe.h,{}),Object(A.jsxs)(_e.b,{children:[Object(A.jsx)(pe.g,{borderBottomWidth:"1px",children:"Search Users"}),Object(A.jsxs)(pe.b,{children:[Object(A.jsxs)(l.a,{d:"flex",pb:2,children:[Object(A.jsx)(m.a,{placeholder:"Search by name or email",mr:2,value:e,onChange:e=>t(e.target.value)}),Object(A.jsx)(x.a,{onClick:async()=>{if(e)try{c(!0);const t={headers:{Authorization:"Bearer ".concat(j.token)}},{data:a}=await B.a.get("/api/user?search=".concat(e),t);c(!1),s(a)}catch(t){g({title:"Error Occured!",description:"Failed to Load the Search Results",status:"error",duration:5e3,isClosable:!0,position:"bottom-left"})}else g({title:"Please Enter something in search",status:"warning",duration:5e3,isClosable:!0,position:"top-left"})},children:"Go"})]}),r?Object(A.jsx)(he,{}):null===a||void 0===a?void 0:a.map((e=>Object(A.jsx)(ge,{user:e,handleFunction:()=>C(e._id)},e._id))),n&&Object(A.jsx)(M.a,{ml:"auto",d:"flex"})]})]})]})})},ze=(a(131),a(365)),Fe=a(354),Ee=(a(352),a(353)),Be=a(355);var Ie=e=>{let{chat:t}=e;const{isOpen:a,onOpen:s,onClose:r}=Object(xe.a)(),{user:c,setSelectedChat:n,chats:o,setChats:l,appTheme:d}=W(),b="dark"===d,h=Object(I.a)(),[p,u]=Object(i.useState)(""),[O,g]=Object(i.useState)(!1),[y,v]=Object(i.useState)([]),C=Object(i.useMemo)((()=>new Set(((null===t||void 0===t?void 0:t.users)||[]).map((e=>(null===e||void 0===e?void 0:e._id)||e)))),[t]);return Object(A.jsxs)(A.Fragment,{children:[Object(A.jsx)(x.a,{leftIcon:Object(A.jsx)(je.a,{}),w:"100%",size:"sm",colorScheme:"teal",onClick:s,borderRadius:"md",children:"Add member"}),Object(A.jsxs)(pe.a,{isOpen:a,onClose:r,isCentered:!0,children:[Object(A.jsx)(pe.h,{}),Object(A.jsxs)(pe.d,{bg:b?"gray.800":"white",color:b?"gray.100":"inherit",children:[Object(A.jsx)(pe.g,{children:"Add member"}),Object(A.jsx)(pe.c,{}),Object(A.jsxs)(pe.b,{children:[Object(A.jsx)(m.a,{placeholder:"Search by name or email",value:p,onChange:e=>(async t=>{if(u(t),!t)return v([]);try{g(!0);const e={headers:{Authorization:"Bearer ".concat(c.token)}},{data:a}=await B.a.get("/api/user?search=".concat(encodeURIComponent(t)),e),s=new Set,i=(a||[]).filter((e=>e._id!==c._id&&!C.has(e._id))).filter((e=>!s.has(e._id)&&(s.add(e._id),!0)));v(i)}catch(e){console.error(e)}finally{g(!1)}})(e.target.value),bg:b?"gray.700":"white"}),Object(A.jsxs)(f.c,{align:"stretch",mt:3,spacing:2,maxH:"300px",overflowY:"auto",children:[O&&Object(A.jsx)(M.a,{size:"sm"}),!O&&0===y.length&&p&&Object(A.jsx)(j.a,{color:b?"gray.400":"gray.600",fontSize:"sm",px:1,children:"No users found"}),!O&&y.map((e=>Object(A.jsxs)(f.a,{justify:"space-between",p:2,borderRadius:"md",_hover:{bg:b?"whiteAlpha.100":"gray.50"},children:[Object(A.jsxs)(f.a,{children:[Object(A.jsx)(V.a,{size:"sm",name:e.name,src:e.pic}),Object(A.jsx)(j.a,{children:e.name})]}),Object(A.jsx)(x.a,{size:"xs",colorScheme:"blue",onClick:()=>(async e=>{try{const a={headers:{Authorization:"Bearer ".concat(c.token)}},{data:s}=await B.a.put("/api/chat/groupadd",{chatId:t._id,userId:e},a);if(n(s),Array.isArray(o)){const e=o.map((e=>e._id===s._id?s:e));l(e)}h({title:"Member added",status:"success",duration:2e3,isClosable:!0}),r()}catch(i){var a,s;h({title:"Failed to add",description:(null===i||void 0===i||null===(a=i.response)||void 0===a||null===(s=a.data)||void 0===s?void 0:s.message)||"",status:"error",duration:3e3,isClosable:!0})}})(e._id),children:"Add"})]},e._id)))]})]}),Object(A.jsx)(pe.f,{children:Object(A.jsx)(x.a,{variant:b?"outline":"ghost",onClick:r,children:"Close"})})]})]})]})};var Re=e=>{let{chat:t,variant:s="dark"}=e;const{user:i,appTheme:r,setAppTheme:c,setSelectedChat:n,chats:o,setChats:d}=W(),b=Boolean(null===t||void 0===t?void 0:t.isGroupChat),h=!b&&t?q(i,t.users):null,x="dark"===r,p=x?"gray.200":"gray.600",u=Object(I.a)();return Object(A.jsxs)(f.c,{w:{base:"0",xl:"22%"},display:{base:"none",xl:"flex"},h:"full",maxH:"100%",minH:"0",overflowY:"auto",p:4,spacing:4,bg:x?"gray.800":"white",borderRadius:"lg",borderWidth:"1px",borderColor:x?"whiteAlpha.300":"gray.200",color:x?"gray.100":"inherit",align:"stretch",children:[Object(A.jsxs)(f.c,{spacing:2,align:"center",py:2,children:[Object(A.jsx)(V.a,{size:"xl",name:b?null===t||void 0===t?void 0:t.chatName:K(t,null===h||void 0===h?void 0:h._id,null===h||void 0===h?void 0:h.name),src:b||null===h||void 0===h?void 0:h.pic}),Object(A.jsx)(j.a,{fontWeight:"700",fontSize:"lg",noOfLines:1,children:b?null===t||void 0===t?void 0:t.chatName:K(t,null===h||void 0===h?void 0:h._id,null===h||void 0===h?void 0:h.name)}),Object(A.jsx)(S.a,{colorScheme:"green",variant:"subtle",children:"Active now"})]}),Object(A.jsx)(ve.a,{borderColor:x?"whiteAlpha.300":"gray.200"}),b?Object(A.jsxs)(f.c,{align:"stretch",spacing:2,children:[Object(A.jsx)(ze.a,{allowToggle:!0,children:Object(A.jsxs)(ze.d,{border:"none",children:[Object(A.jsxs)(ze.b,{_expanded:{bg:x?"whiteAlpha.100":"gray.50"},borderRadius:"md",px:0,children:[Object(A.jsx)(l.a,{as:"span",flex:"1",textAlign:"left",fontWeight:"600",children:"Customize chat"}),Object(A.jsx)(ze.c,{})]}),Object(A.jsxs)(ze.e,{px:0,pb:2,children:[Object(A.jsxs)(f.a,{justify:"space-between",p:2,borderRadius:"md",_hover:{bg:x?"whiteAlpha.100":"gray.50"},children:[Object(A.jsxs)(f.a,{children:[Object(A.jsx)(Ee.a,{color:p}),Object(A.jsx)(j.a,{children:"Dark mode"})]}),Object(A.jsx)(Fe.a,{isChecked:x,onChange:e=>c(e.target.checked?"dark":"light")})]}),b&&Object(A.jsxs)(f.a,{justify:"space-between",p:2,borderRadius:"md",_hover:{bg:x?"whiteAlpha.100":"gray.50"},mt:2,children:[Object(A.jsx)(j.a,{flex:"1",children:"Group name"}),Object(A.jsx)("input",{defaultValue:(null===t||void 0===t?void 0:t.chatName)||"",onBlur:e=>{const s=e.target.value.trim();s&&s!==(null===t||void 0===t?void 0:t.chatName)&&(async()=>{try{const e=(await Promise.resolve().then(a.t.bind(null,9,7))).default,r={headers:{Authorization:"Bearer ".concat(i.token)}},{data:c}=await e.put("/api/chat/rename",{chatId:t._id,chatName:s},r);if(n(c),Array.isArray(o)){const e=o.map((e=>e._id===c._id?c:e));d(e)}}catch(e){}})()},style:{background:x?"#374151":"white",color:x?"#E5E7EB":"inherit",border:"1px solid",borderColor:x?"rgba(255,255,255,0.2)":"#E2E8F0",borderRadius:6,padding:"6px 10px",minWidth:160}})]})]})]})}),Object(A.jsx)(ve.a,{borderColor:x?"whiteAlpha.300":"gray.200"}),Object(A.jsx)(ze.a,{allowToggle:!0,children:Object(A.jsxs)(ze.d,{border:"none",children:[Object(A.jsxs)(ze.b,{_expanded:{bg:x?"whiteAlpha.100":"gray.50"},borderRadius:"md",px:0,children:[Object(A.jsx)(l.a,{as:"span",flex:"1",textAlign:"left",fontWeight:"600",children:"Chat members"}),Object(A.jsx)(ze.c,{})]}),Object(A.jsxs)(ze.e,{px:0,pb:2,children:[Object(A.jsx)(f.c,{align:"stretch",spacing:1,maxH:"260px",overflowY:"auto",children:((null===t||void 0===t?void 0:t.users)||[]).map((e=>Object(A.jsxs)(f.a,{justify:"space-between",p:2,borderRadius:"md",_hover:{bg:x?"whiteAlpha.100":"gray.50"},children:[Object(A.jsxs)(f.a,{children:[Object(A.jsx)(V.a,{size:"sm",name:e.name,src:e.pic}),Object(A.jsxs)(j.a,{children:[K(t,e._id,e.name),e._id===i._id?" (You)":""]})]}),e._id!==i._id&&Object(A.jsx)(w.a,{"aria-label":"remove",icon:Object(A.jsx)(Be.a,{}),size:"xs",variant:"ghost",color:p,onClick:()=>(async e=>{if(null===t||void 0===t?void 0:t._id)try{const a={headers:{Authorization:"Bearer ".concat(i.token)}},{data:s}=await B.a.put("/api/chat/groupremove",{chatId:t._id,userId:e},a);if(n(s),Array.isArray(o)){const e=o.map((e=>e._id===s._id?s:e));d(e)}u({title:"Member removed",status:"success",duration:2e3,isClosable:!0})}catch(r){var a,s;u({title:"Failed to remove",description:(null===r||void 0===r||null===(a=r.response)||void 0===a||null===(s=a.data)||void 0===s?void 0:s.message)||"",status:"error",duration:3e3,isClosable:!0})}})(e._id)})]},e._id)))}),Object(A.jsx)(l.a,{pt:2,children:Object(A.jsx)(Ie,{chat:t})})]})]})})]}):Object(A.jsx)(f.c,{align:"stretch",spacing:2,children:Object(A.jsx)(ze.a,{allowToggle:!0,children:Object(A.jsxs)(ze.d,{border:"none",children:[Object(A.jsxs)(ze.b,{_expanded:{bg:x?"whiteAlpha.100":"gray.50"},borderRadius:"md",px:0,children:[Object(A.jsx)(l.a,{as:"span",flex:"1",textAlign:"left",fontWeight:"600",children:"Customize chat"}),Object(A.jsx)(ze.c,{})]}),Object(A.jsx)(ze.e,{px:0,pb:2,children:Object(A.jsxs)(f.a,{justify:"space-between",p:2,borderRadius:"md",_hover:{bg:x?"whiteAlpha.100":"gray.50"},children:[Object(A.jsxs)(f.a,{children:[Object(A.jsx)(Ee.a,{color:p}),Object(A.jsx)(j.a,{children:"Dark mode"})]}),Object(A.jsx)(Fe.a,{isChecked:x,onChange:e=>c(e.target.checked?"dark":"light")})]})})]})})})]})};var We=()=>{const[e,t]=Object(i.useState)(""),[a,s]=Object(i.useState)([]),{user:r,chats:c,setChats:n,setSelectedChat:o,appTheme:b}=W(),h="dark"===b;return Object(A.jsxs)(l.a,{bg:h?"gray.800":"white",borderWidth:"1px",borderRadius:"lg",p:6,h:"100%",color:h?"gray.100":"inherit",children:[Object(A.jsx)(d.a,{size:"md",mb:3,children:"To:"}),Object(A.jsxs)(O.a,{mb:4,children:[Object(A.jsx)(g.a,{pointerEvents:"none",children:Object(A.jsx)(ke.a,{color:h?"gray.300":"brand.secondary"})}),Object(A.jsx)(m.a,{placeholder:"Search contacts",value:e,onChange:e=>(async e=>{if(t(e),!e)return s([]);const a={headers:{Authorization:"Bearer ".concat(r.token)}},{data:i}=await B.a.get("/api/user?search=".concat(encodeURIComponent(e)),a);s(i)})(e.target.value),bg:h?"gray.700":"white",borderColor:h?"whiteAlpha.300":void 0})]}),Object(A.jsxs)(f.c,{align:"stretch",spacing:0,maxH:"calc(100% - 100px)",overflowY:"auto",borderWidth:"1px",borderRadius:"md",borderColor:h?"whiteAlpha.300":void 0,children:[!a.length&&Object(A.jsx)(l.a,{p:6,color:h?"gray.400":"gray.500",children:"Search and select a contact"}),a.map((e=>Object(A.jsxs)(f.a,{p:3,_hover:{bg:h?"whiteAlpha.100":"gray.50"},cursor:"pointer",onClick:()=>(async e=>{const t={headers:{"Content-type":"application/json",Authorization:"Bearer ".concat(r.token)}},{data:a}=await B.a.post("/api/chat",{userId:e},t);c.find((e=>e._id===a._id))||n([a,...c]),o(a)})(e._id),children:[Object(A.jsx)(V.a,{size:"sm",name:e.name,src:e.pic}),Object(A.jsxs)(f.c,{spacing:0,align:"start",flex:1,children:[Object(A.jsx)(j.a,{fontWeight:600,children:e.name}),Object(A.jsx)(j.a,{fontSize:"sm",color:h?"gray.400":"gray.500",children:e.email})]}),Object(A.jsx)(x.a,{size:"sm",bg:"brand.primary",_hover:{bg:"#1EB85A"},color:"white",children:"Chat"})]},e._id)))]})]})},Te=a(364);var Ne=e=>{let{onSelectUser:t,closeModal:a,selectedUsers:s}=e;const[r,c]=Object(i.useState)([]);Object(i.useEffect)((()=>{(async()=>{try{const e=await B.a.get("http://localhost:5000/api/users/get-users");c(e.data)}catch(e){console.error("Error fetching users:",e)}})()}),[]);return Object(A.jsxs)(pe.a,{isOpen:!0,onClose:a,children:[Object(A.jsx)(pe.h,{}),Object(A.jsxs)(pe.d,{children:[Object(A.jsx)(pe.g,{children:"Select Users to Add to Group"}),Object(A.jsx)(pe.c,{}),Object(A.jsxs)(pe.b,{children:[Object(A.jsx)(f.c,{spacing:4,align:"stretch",children:r.map((e=>Object(A.jsx)(Te.a,{isChecked:s.some((t=>t._id===e._id)),onChange:()=>(e=>{const a=s.some((t=>t._id===e._id));t(a?s.filter((t=>t._id!==e._id)):[...s,e])})(e),children:e.username},e._id)))}),Object(A.jsx)(x.a,{mt:4,colorScheme:"blue",onClick:a,children:"Done"})]})]})]})};var De=()=>{const[e,t]=Object(i.useState)(!1),{user:a,appTheme:s}=W(),[r,c]=Object(i.useState)(!1),[n,o]=Object(i.useState)("chat"),[d,j]=Object(i.useState)([]),[b,h]=Object(i.useState)([]),[p,u]=Object(i.useState)(!1);Object(i.useEffect)((()=>{a&&(async()=>{try{const e=await B.a.get("http://localhost:5000/api/groups/get-groups",{headers:{Authorization:"Bearer ".concat(a.token)}});j(e.data)}catch(e){console.error("Error fetching groups",e)}})()}),[a,e]);return Object(A.jsxs)("div",{style:{width:"100%"},children:[a&&Object(A.jsx)(Ae,{}),Object(A.jsxs)(P.a,{justifyContent:"space-between",w:"100%",h:"100vh",p:{base:2,md:4},bg:"dark"===s?"gray.900":"gray.50",children:[a&&Object(A.jsx)(Se,{fetchAgain:e,variant:"light",containerProps:{w:{base:"0",md:"28%"},display:{base:"none",md:"flex"},h:"100%"},onStartNew:()=>o("new"),onSelectChat:()=>o("chat"),groups:d}),a&&("new"===n?Object(A.jsx)(l.a,{flex:1,mx:{base:0,md:4},h:"100%",children:Object(A.jsx)(We,{})}):Object(A.jsx)(de,{fetchAgain:e,setFetchAgain:t,variant:"dark"===s?"dark":"light",containerProps:{flex:1,mx:{base:0,md:4},h:"100%"},onToggleInfo:()=>c((e=>!e))})),a&&r&&Object(A.jsx)(Re,{chat:W().selectedChat})]}),Object(A.jsx)(x.a,{onClick:()=>u(!0),colorScheme:"teal",variant:"solid",children:"Create Group"}),p&&Object(A.jsx)(Ne,{onSelectUser:e=>h([...b,e]),closeModal:()=>u(!1),selectedUsers:b})]})};var Ge=function(){return Object(A.jsxs)("div",{className:"App",children:[Object(A.jsx)(h.a,{path:"/",component:G,exact:!0}),Object(A.jsx)(h.a,{path:"/chats",component:De})]})};var Pe,Le,Ue=e=>{e&&e instanceof Function&&a.e(3).then(a.bind(null,373)).then((t=>{let{getCLS:a,getFID:s,getFCP:i,getLCP:r,getTTFB:c}=t;a(e),s(e),i(e),r(e),c(e)}))},Ve=a(361),Me=a(74),Je=a(357);const Ye={heading:"Work Sans, ".concat((null===(Pe=Me.theme.fonts)||void 0===Pe?void 0:Pe.heading)||"system-ui"),body:"Inter, ".concat((null===(Le=Me.theme.fonts)||void 0===Le?void 0:Le.body)||"system-ui")},$e={brand:{primary:"#25D366",secondary:"#075E54",background:"#F5F6FA",text:"#202C33",surface:"#FFFFFF"}},He={Button:{baseStyle:{fontWeight:600},variants:{solid:{borderRadius:"md",bg:$e.brand.primary,color:"white",_hover:{bg:"#1EB85A"},_active:{bg:"#197F40"}},ghost:{color:$e.brand.secondary,_hover:{bg:"rgba(7,94,84,0.08)"}}},defaultProps:{variant:"solid"}},Tabs:{baseStyle:{tab:{_selected:{color:$e.brand.secondary,borderColor:$e.brand.secondary}}}},Accordion:{baseStyle:{button:{_focus:{boxShadow:"none",outline:"none"},_focusVisible:{boxShadow:"none",outline:"none"}}}},Input:{defaultProps:{focusBorderColor:$e.brand.secondary}}},qe={global:{body:{bg:$e.brand.background,color:$e.brand.text}}};var Ke=Object(Je.a)({fonts:Ye,components:He,styles:qe,colors:$e,config:{initialColorMode:"light",useSystemColorMode:!1}}),Qe=a(66);n.a.render(Object(A.jsx)(Ve.a,{theme:Ke,children:Object(A.jsx)(Qe.a,{children:Object(A.jsx)(T,{children:Object(A.jsx)(Ge,{})})})}),document.getElementById("root")),Ue()}},[[310,1,2]]]);
//# sourceMappingURL=main.e84c0742.chunk.js.map